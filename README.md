# Stream processing and storing with Kafka, Spark and HDFS


This Spark-based code is run at the A-Fog (Analytics Fog) tier in our proposed multi-layer stream and big data analytics platform to catch carparks’ occupancies data streamed from multiple S-Fog systems, then store these data in the A-Fog’s HDFS for long-term data storage and large-scale data analytics later. 


![image](https://user-images.githubusercontent.com/33792183/149578793-f3d16e0e-c8a4-4b0e-866a-b1ef147276e2.png)


![image](https://user-images.githubusercontent.com/33792183/149578019-e79fc924-dff3-4eb6-8a1f-44fb28fd35a5.png)


![image](https://user-images.githubusercontent.com/33792183/149578455-059b7517-06aa-48c4-9ad7-9cff5a5b4e0c.png)

More details could be found in our publication in the IEEE Internet of Things journal here: 


Nguyen, S., Salcic, Z., Zhang, X., & Bisht, A. (2020). A Low-Cost Two-Tier Fog Computing Testbed for Streaming IoT-Based Applications. _IEEE Internet of Things Journal, 8(8), 6928-6939._ (Link: https://ieeexplore.ieee.org/abstract/document/9249378)
